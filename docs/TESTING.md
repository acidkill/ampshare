# Testing in AmpShare

This document outlines the testing setup, conventions, and guidelines for the AmpShare project.

## Testing Stack

Our testing stack includes:

*   **Jest**: A JavaScript testing framework.
*   **React Testing Library**: For testing React components in a user-centric way.
*   **@testing-library/jest-dom**: Provides custom Jest matchers for asserting on DOM elements.
*   **@testing-library/user-event**: For simulating user interactions.
*   **TypeScript**: All tests are written in TypeScript.

## Running Tests

*   **Run all tests**:
    ```bash
    npm run test
    ```
    This command will also generate a coverage report in the `coverage/` directory.

*   **Run a single test file**:
    ```bash
    npm test -- <path_to_test_file.test.ts>
    ```
    Example: `npm test -- src/lib/auth.test.ts`

*   **Run tests in watch mode**:
    ```bash
    npm test -- --watch
    ```
    This is useful for re-running tests automatically as you make changes.

## Test File Conventions

*   **Location**: Test files should be co-located with the source files they are testing or placed within a `__tests__` directory alongside the source files.
*   **Naming**: Test files should use the `.test.ts` extension for general TypeScript files or `.test.tsx` for files containing JSX (React components).

## Coverage

Test coverage is automatically collected when running `npm run test`.
*   The report is generated in the `coverage/` directory. You can open `coverage/lcov-report/index.html` in a browser to view detailed coverage.
*   **Current Configuration**: Coverage is collected from `src/**/*.{ts,tsx}`, excluding test files, `src/types.ts`, `src/lib/db.ts` (mock DB), and `src/app/layout.tsx`.

## Current Coverage Status and Test Plan

As of the latest run:

*   **`src/lib/auth.ts`**: Achieved 97.56% statement coverage. The small portion of uncovered lines primarily relates to `console.error` calls within error handling paths. Given that the core error handling behavior (e.g., returning `undefined`) is tested, this coverage level is currently considered sufficient for this module.

### Test Plan for New Features

*   **Primary Gap**: The main test coverage gap is the absence of tests for application features outlined in `docs/blueprint.md` (e.g., Scheduling Interface, Combined Schedule Display, Conflict Detection, Real-time Alerts, User Management UI) because the corresponding application logic has not yet been implemented.
*   **Concurrent Test Development**: For all new features, unit and integration tests will be developed concurrently with the feature implementation itself. This ensures that new code is tested from the outset.
*   **Adherence to Guidelines**: All new tests will follow the conventions and guidelines outlined in this document.
*   **Coverage Monitoring**: The test coverage report (generated by `npm run test` and available in `coverage/lcov-report/index.html`) should be regularly reviewed as the application evolves. This practice will help identify any new coverage gaps or regressions.
*   **Focus Areas for New Tests**:
    *   **Component Tests**: UI components (primarily in `src/app/`) will be tested using React Testing Library to verify rendering, user interactions, and state changes.
    *   **Logic Tests**: Business logic (e.g., scheduling algorithms, conflict detection) will have dedicated unit tests.
    *   **Integration Tests**: Key user flows (e.g., logging in, creating a schedule, resolving a conflict) will be covered by integration tests.
